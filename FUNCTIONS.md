# Описание функций и модулей проекта "Моя библиотека"

Этот документ служит технической документацией для фронтенд-части приложения, объясняя назначение каждого модуля и ключевых функций.

## Архитектура фронтенда (`public/js/`)

Код разделен на несколько модулей для лучшей организации и поддержки.

### `main.js`

Главный управляющий файл ("дирижер").

-   **Назначение:** Инициализирует приложение, устанавливает глобальные обработчики событий (на фильтры, поиск, сортировку) и координирует работу других модулей.
-   **Ключевые функции:**
    -   `initApp()`: Запускается один раз при загрузке страницы. Получает все данные о книгах с сервера через `api.js`, сохраняет их в `state.js` и запускает первую отрисовку.
    -   `applyFiltersAndSearch()`: Центральная функция, которая вызывается при любом изменении фильтров, поиска или сортировки. Она последовательно применяет все критерии к полному списку книг, а затем запускает логику пагинации и рендеринга.
    -   `setupEventListeners()`: Устанавливает все "прослушки" событий на элементы управления.

### `state.js`

Модуль для хранения глобального состояния приложения.

-   **Назначение:** Централизованное хранение данных, чтобы избежать их дублирования и передачи между всеми функциями.
-   **Ключевые экспорты:**
    -   `state`: Объект, содержащий `allBooksData` (полный список книг с сервера), `currentlyDisplayedBooks` (отфильтрованный и отсортированный список для текущего отображения), `currentPage` и другие параметры.
    -   `updateState()`: Функция для безопасного обновления состояния.

### `api.js`

Модуль для работы с сервером.

-   **Назначение:** Инкапсулирует всю сетевую логику. Все `fetch`-запросы находятся здесь.
-   **Ключевые функции:** `fetchAllBooks()`, `fetchRecommendations()`, `updateBook()`, `deleteBook()`, `moveBookLocation()`, `addBook()`. Каждая функция соответствует одному API-эндпоинту на бэкенде.

### `ui/bookCards.js`

Модуль, отвечающий за отображение книг на главной странице.

-   **Назначение:** Отвечает только за внешний вид списка книг.
-   **Ключевые функции:**
    -   `renderBooks()`: Принимает массив книг и генерирует для них HTML-карточки. Умеет работать в двух режимах: полная замена списка (`append: false`) или добавление в конец (`append: true` для кнопки "Показать еще"). Также содержит логику для отображения плейсхолдеров для цифровых книг.
    -   `translateStatus()`: Вспомогательная функция для перевода статуса книги на русский язык.

### `ui/modals.js`

Модуль для всей логики, связанной с модальными окнами.

-   **Назначение:** Управляет отображением, наполнением и обработкой действий в модальных окнах детального просмотра и редактирования.
-   **Ключевые функции:**
    -   `showDetailModal()`: Главная функция, которая вызывается при клике на карточку книги.
    -   `renderDetailView()`: Генерирует HTML для модального окна в режиме **просмотра**. Отображает все поля из объекта книги.
    -   `renderEditView()`: Генерирует HTML для модального окна в режиме **редактирования**, превращая текстовые поля в инпуты и селекты.
    -   `renderRecommendations()`: Генерирует HTML для блока с похожими книгами.
    -   `handleSaveChanges()`, `handleDeleteBook()`, `handleMoveBook()`: Функции-обработчики, которые вызываются при нажатии на соответствующие кнопки в модальном окне. Они, в свою очередь, вызывают функции из `api.js` для отправки запросов на сервер.
